metadata:
  name: gradient_based
  description: Simplified channel selector pipeline for cuvis-ai-core testing
  created: ''
  tags:
  - test
  - gradient_based
  - statistical
  - gradient
  author: Cubert GmbH
  cuvis_ai_version: ''

nodes:
- name: LentilsAnomalyDataNode
  class_name: tests.fixtures.mock_nodes.LentilsAnomalyDataNode
  hparams:
    normal_class_ids:
    - 0
    - 1

- name: SoftChannelSelector
  class_name: tests.fixtures.mock_nodes.SoftChannelSelector
  hparams:
    n_select: 3
    input_channels: 61
    init_method: variance
    temperature_init: 5.0
    temperature_min: 0.1
    temperature_decay: 0.9
    hard: false
    eps: 1.0e-06

- name: SimpleLossNode
  class_name: tests.fixtures.mock_nodes.SimpleLossNode
  hparams:
    weight: 1.0

- name: MockMetricNode
  class_name: tests.fixtures.mock_nodes.MockMetricNode
  hparams: {}

connections:
- source: LentilsAnomalyDataNode.outputs.cube
  target: SoftChannelSelector.inputs.data

# Loss node connections (predictions + targets for testing)
- source: SoftChannelSelector.outputs.selected
  target: SimpleLossNode.inputs.predictions
- source: LentilsAnomalyDataNode.outputs.cube
  target: SimpleLossNode.inputs.targets

# Metric node connections (same inputs as loss)
- source: SoftChannelSelector.outputs.selected
  target: MockMetricNode.inputs.predictions
- source: LentilsAnomalyDataNode.outputs.cube
  target: MockMetricNode.inputs.targets
